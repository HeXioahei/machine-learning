> B站吴恩达深度学习课程
# CV概述
## CV解决的问题
* 图片分类（Image Classification）
* 目标检测（Object Detection）
* 图片风格迁移（Neural Style Transfer）

## 卷积在处理大图像上的作用
对于一张64×64像素大小的图像，他的数据有64×64×3=12288个（3指的是颜色通道数，RGB三个）。这如果直接用全连接层来处理的话，尚且还能处理得了。

但是如果图片变大，比如1000×1000像素大小，那么，输入数据就有3m个（1m=1000,000），是一个(1, 3m)的矩阵。假设隐藏神经元只有1000个，那么，输入层与隐藏层之间得权重矩阵 w 就是维度为(3m, 1000)大小的矩阵，有3m×1000=3b（1b=1000,000,000）个参数，这是一个很大的数量级，会占用很大的内存。

所以，我们就需要用到卷积来处理大图像。

# 边缘检测
## 有什么作用
边缘检测可以用来识别物体，有垂直边缘检测、水平边缘检测等

例如，一张图片如下：
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111615584.png)

* 垂直边缘检测
	![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111616417.png)
* 水平边缘检测
	![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111617931.png)

## 如何进行边缘检测呢
### 示例
例如，对于一张6×6的灰度图片，因为它是灰度图片，所以颜色通道数为1，所以，它是一个64×64×1的矩阵。如下图所示：
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111622075.png)（图像矩阵）

为了进行图像边缘检测，我们可以构造一个3×3的矩阵，习惯上，我们把它称为过滤器（filter）或者是核（kernel）（也即常说的“卷积核”）。对于垂直边缘检测，我们把卷积核构造如下：
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111626240.png)（核矩阵）

可以明显地看出，这个和矩阵的数据分布很具备垂直特征，因此，它可以很好的提取图像的垂直特征，具体怎么提取呢？我们接着往下。

我们对图像矩阵和核矩阵进行卷积运算（Convolution Operation），该运算可以用符号`“*”`表示。根据卷积运算规则：新宽 = （原宽 + 填充×2 - 卷积核边长）/ 步长 + 1，最终将得到一个4×4的矩阵，即4×4的图像。计算过程大致如下：
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111634994.png)

依次类推，移动蓝色方块，不断计算出4×4矩阵中所有的值。结果如下：
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111636994.png)

### 为什么这样的构造和计算可以检测边缘呢
我们可以用一个极端的例子来说明，如下：
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111645891.png)

数值越大的地方就越亮。这么一看就一目了然啦！不过需要注意的是，在这个例子中，核矩阵和图片矩阵的亮度分布是一致的，都是左亮右暗（即左边的数值大，有的数值小），所以结果图片矩阵产生的分界线是亮的（即中间是亮的）。如果核矩阵和图片矩阵的亮度分布是相反的，即一个是左亮右暗，一个是左暗右亮，那么最终分界线是暗线。

## 进一步了解边缘检测
### 边缘过渡
我们沿着上文讲的继续扩充，如下图：
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111704268.png)

我们使用左亮右暗的核矩阵，那么，如果原图片从左到右是由亮到暗的过渡的话，中间的分界线就会是亮线，如果是由暗到亮的过渡的话，中间的分界线就会是暗线。如此般来，我们就可以由分界线的亮暗来判断原图片颜色是如何过渡的了。

如果我们不在乎这个颜色过渡的话，可以直接把结果计算为绝对值。

水平检测和垂直检测就是一样的道理了。

还有值得注意的是，垂直检测实现的是水平方向上的分割，水平检测实现的是垂直方向上的分割。

### 不同的过滤器
曾经，CV学者们争议过哪种过滤器是最好的。有一些比较常用的经典的filter。如：
* Sobel Filter
	![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111718572.png)
	它的优点在于：增加了中间一行的权重，这使得结果的鲁棒性会更高一些（鲁棒性：一个系统或算法在面对输入数据中的扰动、噪声、异常值或设计参数变化时，仍然能够保持其预期功能、性能稳定且结果准确的能力）。
* Scharr Filter
	![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410111722662.png)

当然，我们不一定非要用上面提到的这些过滤器中的参数不可，在后文中，我们将学习到逆向传播算法，它可以通过自学习来不断优化过滤器中的参数，以达到最佳的效果。我们只需先给过滤器中的9个参数初始化，然后让他在训练中不断学习来调整参数即可。

不仅如此，通过反向传播的自学习，我们还可以实现对任何角度的边缘的检测，比如45°、73°等，不一定非要垂直和水平不可。

# Padding（填充）

