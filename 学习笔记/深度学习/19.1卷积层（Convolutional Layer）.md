> 课程：李沐《动手学深度学习》and  哔哩哔哩up主“FunInCode”【数之道】系列视频
# 从全连接到卷积
## 分类猫和狗的图片
使用一个还不错的相机采集图片（12M像素） （1M=1000,000）。则RGB图片有36M个元素。使用100大小的单隐藏层MLP，则模型有3.6B个元素（1B=1000,000,000）。这远多于世界上所有猫和狗的总数。

3.6B个参数，大概需要14GB的储存空间。

## 两个原则
* 平移不变性：识别效果不会因为目标像素位置的改变而发生改变。不管在哪里都可以识别。
* 局部性：识别目标时，不需要观察整个图片，只需观察目标周围的部分便可以识别出目标。

## 重新考察全连接层
全连接层将一维的输入和输出变形为矩阵（矩阵具有宽度和高度，是二维的），而权重要把输入和输出联系起来，所以它与输入数据在输入矩阵中的位置和输出数据在输出矩阵中的位置都有关系，而输入和输出现在都是二维的矩阵，都由两个变量（行位和列位）来决定位置，所以相应的，权重就与四个变量有关，所以权重变成了一个四维的张量（从输入(h,w)到输出(h',w')）。
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410062232473.png)

## 两个原则的实现
* ![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410062231639.png)
* ![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410062231242.png)
## 总结
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410062236871.png)

# 卷积层
## 二维交叉相关
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410062236469.png)

## 二维卷积层
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410062245751.png)

## 交叉相关vs卷积
![image.png](https://youki-1330066034.cos.ap-guangzhou.myqcloud.com/machine-learning/202410062248601.png)

## 一维和三维交叉相关
* 一维：文本、语言、时序序列
* 二维：图片
* 三维：视频、医学图像、气象地图

## 总结
* 卷积层将输入和和矩阵进行交叉相关计算，加上偏移量后得到输出
* 核矩阵和偏移量是可学习的参数
* 核矩阵的大小是超参数，这个大小控制了局部性，大的话，输出的每个点观察到的获取的信息就多，小的话就少
* 全连接层存在着随着输入变大权重也变大的问题，而卷积不存在这个问题。他的权重固定为和矩阵大小。

---

> 课程：[【数之道 08】走进"卷积神经网络"，了解图像识别背后的原理_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1R5411w715/?spm_id_from=333.788&vd_source=327f3e87e497fe83b3515199232efd15)

（卷积层里的通道数是不是就对应着全连接层里的维度？）（好像是这样的）

——不，并不是这样的。卷积层的输出通道数是由卷积核的数量决定的，而全连接层的输入维度是由上一层的输出维度决定的。一个卷积核里有和输入通道数相同数目的卷积面，它们分别进行对应的卷积求和操作，得到的缩小的面再进行相加，就得到了一个新的输出通道，也就对应着一张新的特征图。一个卷积层里有多个卷积核，就会有多个输出通道，产生多个特征图。这些图最后进行扁平化处理，变成一个一维向量，而全连接层的输入正是这个向量。就这样输入全连接层，最终根据需求决定全连接层的输出通道个数，进行输出。

---
> 课程：b站吴恩达深度学习课程
> [112.1.5 卷积步长_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV11H4y1F7uH?p=109&vd_source=327f3e87e497fe83b3515199232efd15)
